CREATE MATERIALIZED VIEW MV_RPRT_STUD_DETAILS
REFRESH FAST ON DEMAND
AS
SELECT
SCR.SUBTEST_FACTID,
SCR.STUDENT_BIO_ID,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_BIO(P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO',P_ADMINID=>SCR.ADMINID,P_GRADEID=>SCR.GRADEID,P_GENDERID=>SCR.GENDERID,P_COLUMNTYPE=>'FIRST_NAME') AS FIRST_NAME,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_BIO(P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO',P_ADMINID=>SCR.ADMINID,P_GRADEID=>SCR.GRADEID,P_GENDERID=>SCR.GENDERID,P_COLUMNTYPE=>'LAST_NAME') AS LAST_NAME,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_BIO(P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO',P_ADMINID=>SCR.ADMINID,P_GRADEID=>SCR.GRADEID,P_GENDERID=>SCR.GENDERID,P_COLUMNTYPE=>'MIDDLE_NAME') AS MIDDLE_NAME,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_BIO(P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO',P_ADMINID=>SCR.ADMINID,P_GRADEID=>SCR.GRADEID,P_GENDERID=>SCR.GENDERID,P_COLUMNTYPE=>'BIRTHDATE') AS BIRTHDATE,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_BIO(P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO',P_ADMINID=>SCR.ADMINID,P_GRADEID=>SCR.GRADEID,P_GENDERID=>SCR.GENDERID,P_COLUMNTYPE=>'EXT_STUDENT_ID') AS EXT_STUDENT_ID,
PKG_RPRT_STUD_DETAILS.SF_GET_DISTRICT_NAME(P_ORG_NODEID =>SCR.ORG_NODEID,P_CUSTOMER_CODE=>'MO') AS DISTICT_NAME,
PKG_RPRT_STUD_DETAILS.SF_GET_SCHOOL_NAME(P_ORG_NODEID =>SCR.ORG_NODEID,P_CUSTOMER_CODE=>'MO') AS SCHOOL_NAME,
PKG_RPRT_STUD_DETAILS.SF_GET_DISTRICTID(P_ORG_NODEID =>SCR.ORG_NODEID,P_CUSTOMER_CODE=>'MO') AS DISTRICT_ORG_NODEID,
SCR.ORG_NODEID AS SCHOOL_ORG_NODEID,
SCR.CUST_PROD_ID,
SCR.ASSESSMENTID,
SCR.CONTENTID,
SCR.SUBTESTID,
PKG_RPRT_STUD_DETAILS.SF_GET_SUBTEST_DETAILS( P_SUBTESTID=>SCR.SUBTESTID, P_COLUMNTYPE =>'SUBTEST_NAME') AS SUBTEST_NAME,
PKG_RPRT_STUD_DETAILS.SF_GET_SUBTEST_DETAILS( P_SUBTESTID=>SCR.SUBTESTID, P_COLUMNTYPE =>'SUBTEST_CODE') AS SUBTEST_CODE,
PKG_RPRT_STUD_DETAILS.SF_GET_SUBTEST_DETAILS( P_SUBTESTID=>SCR.SUBTESTID, P_COLUMNTYPE =>'SUBTEST_SEQ') AS SUBTEST_SEQ,
SCR.GENDERID,
SCR.GRADEID,
SCR.LEVELID,
SCR.FORMID,
SCR.ADMINID,
SCR.SS,
SCR.PL,
SCR.PR,
SCR.NCR,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_LIST( P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID,P_FORMID=>SCR.FORMID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID,P_ADMINID=>SCR.ADMINID,P_COLUMNTYPE=>'OBJECTIVEID') AS OBJECTIVEIDS,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_LIST( P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID,P_FORMID=>SCR.FORMID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID,P_ADMINID=>SCR.ADMINID,P_COLUMNTYPE=>'PL') AS OBJ_PLS,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL1_LOW_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL1_LOW_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL1_HIGH_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL1_HIGH_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL2_LOW_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL2_LOW_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL2_HIGH_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL2_HIGH_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL3_LOW_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL3_LOW_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL3_HIGH_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL3_HIGH_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL4_LOW_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL4_LOW_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'PL4_HIGH_VAL', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS PL4_HIGH_VAL,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'TOTAL_RANGE', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS TOTAL_RANGE,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'RANGE_BELOW_BASIC', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS RANGE_BELOW_BASIC,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'RANGE_BASIC', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS RANGE_BASIC,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'RANGE_PROFICIENT', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS RANGE_PROFICIENT,
PKG_RPRT_STUD_DETAILS.SF_GET_SCORE_RANGE( P_COLUMNTYPE =>'RANGE_ADVANCED', P_SUBTESTID=>SCR.SUBTESTID,P_GRADEID=>SCR.GRADEID, P_LEVELID=>SCR.LEVELID, P_CUST_PROD_ID=>SCR.CUST_PROD_ID) AS RANGE_ADVANCED,
PKG_RPRT_STUD_DETAILS.SF_GET_SUBTEST_DEMO_EXAMINER( P_SUBTESTID=>SCR.SUBTESTID, P_STUDENT_BIO_ID=>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO') AS EXAMINER,
PKG_RPRT_STUD_DETAILS.SF_GET_SUBTEST_DEMO_VALUE( P_DEMOCODE=>'Accomm_1',P_STUDENT_BIO_ID=>SCR.STUDENT_BIO_ID,P_SUBTESTID=>SCR.SUBTESTID,P_CUSTOMER_CODE=>'MO') AS BRAILLE,
PKG_RPRT_STUD_DETAILS.SF_GET_SUBTEST_DEMO_VALUE( P_DEMOCODE=>'Accomm_2',P_STUDENT_BIO_ID=>SCR.STUDENT_BIO_ID,P_SUBTESTID=>SCR.SUBTESTID,P_CUSTOMER_CODE=>'MO') AS LARGE_PRINT,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_DEMO_VALID( P_DEMOCODE=>'Home_Sch',P_STUDENT_BIO_ID=>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO') AS HOME_SCHOOL,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_DEMO_VALID( P_DEMOCODE=>'Private_Sch',P_STUDENT_BIO_ID=>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO') AS PRIVATE_SCHOOL,
PKG_RPRT_STUD_DETAILS.SF_GET_STUDENT_DEMO_VALID( P_DEMOCODE=>'Race_Ethn',P_STUDENT_BIO_ID=>SCR.STUDENT_BIO_ID,P_CUSTOMER_CODE=>'MO') AS ETHNICITYID,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'01', OBJECTIVE_CODE=>'1', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_ELA_RD_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'01', OBJECTIVE_CODE=>'2', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_ELA_WR_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'01', OBJECTIVE_CODE=>'3', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_ELA_LTSN_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'01', OBJECTIVE_CODE=>'4', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_ELA_RES_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'02', OBJECTIVE_CODE=>'1', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_MA_CONCEPT_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'02', OBJECTIVE_CODE=>'2,4', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_MA_PROB_SLV_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'02', OBJECTIVE_CODE=>'3', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_MA_COMM_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'1', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_MAT_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'2', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_FRC_MTN_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'3', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_LVNG_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'4', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_ECO_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'5', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_ERTH_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'6', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_UNIV_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'7', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_SCINQ_PC,
PKG_RPRT_STUD_DETAILS.SF_GET_OBJECTIVE_SCORE(SUBTEST_CODE=>'03', OBJECTIVE_CODE=>'8', P_STUDENT_BIO_ID =>SCR.STUDENT_BIO_ID, p_columntype =>'PC',p_subtest_id=>SCR.SUBTESTID) AS OBJ_SCI_IMPCT_PC
FROM SUBTEST_SCORE_FACT SCR;
